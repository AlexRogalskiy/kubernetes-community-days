{{ $isHome  := .IsHome }}
{{ $isEvent := and (eq .Section "events") (ne .CurrentSection .FirstSection) }}
{{ $home    := site.BaseURL }}
{{ $logo    := printf "img/logos/%s" site.Params.logo | relURL }}
{{ $menu    := site.Menus.navbar }}
{{ $here    := .RelPermalink }}
{{ $section := .CurrentSection }}
{{ $url     := .RelPermalink }}
{{ $allowed := site.Params.allowed_event_pages }}
<nav class="navbar is-fixed-top{{ if not $isHome }} is-light{{ end }}">
  <div class="container">
    <div class="navbar-brand">
      {{ if not $isHome }}
      <a class="navbar-item" href="{{ $home }}">
        <img src="{{ $logo }}" alt="Kubernetes Community Days navbar logo">
      </a>
      {{ end }}
  
      <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
  
    <div id="navbar-menu" class="navbar-menu">
      <div class="navbar-end">
        {{ if $isEvent }}
        {{ with .CurrentSection }}
        <div class="navbar-item">
          <div class="buttons has-addons">
            {{ $isEventRoot := eq $url .RelPermalink }}
            <a class="button has-text-weight-bold is-radiusless{{ if $isEventRoot }} is-primary{{ else }} is-light{{ end }}" href="{{ .RelPermalink }}">
              Overview
            </a>

            {{ range .Pages }}
            {{ $isAllowed := in $allowed .File.BaseFileName }}
            {{ if $isAllowed }}
            {{ $isActive := eq $url .RelPermalink }}
            <a class="button has-text-weight-bold is-radiusless{{ if $isActive }} is-primary{{ else }} is-light{{ end }}" href="{{ .RelPermalink }}">
              {{ .Title }}
            </a>
            {{ end }}
            {{ end }}
          </div>
        </div>
        {{ end }}
        {{ end }}

        <div class="navbar-item">
          <div class="buttons has-addons">
            {{ range $menu }}
            {{ $isActive := hasPrefix $url .URL }}
            <a class="button has-text-weight-bold is-radiusless{{ if $isActive }} is-primary{{ else }} is-light{{ end }}" href="{{ .URL }}">
              {{ .Name }}
            </a>
            {{ end }}
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>
